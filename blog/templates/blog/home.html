{% extends "layout.html" %}
{% load static %}
{% block title %}Home • Blurry Shady Blog{% endblock %}

{% block meta %}
  {% if q %}
    {% with desc="Search results for '"|add:q|add:"' on Blurry Shady Blog." %}
      <meta name="description" content="{{ desc }}">
      <link rel="canonical" href="{{ request.build_absolute_uri }}">
      <meta property="og:type" content="website">
      <meta property="og:title" content="Search: {{ q }} • Blurry Shady Blog">
      <meta property="og:description" content="{{ desc }}">
      <meta property="og:url" content="{{ request.build_absolute_uri }}">
      <meta property="og:image" content="{% static 'img/og-default.jpg' %}">
      <meta name="twitter:title" content="Search: {{ q }} • Blurry Shady Blog">
      <meta name="twitter:description" content="{{ desc }}">
      <meta name="twitter:image" content="{% static 'img/og-default.jpg' %}">
    {% endwith %}
  {% else %}
    <meta name="description" content="Latest writing on indie hacking, coding, and creative experiments by Blurry Shady.">
    <link rel="canonical" href="{{ request.build_absolute_uri }}">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Blurry Shady Blog">
    <meta property="og:description" content="Latest writing on indie hacking, coding, and creative experiments.">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:image" content="{% static 'img/og-default.jpg' %}">
    <meta name="twitter:title" content="Blurry Shady Blog">
    <meta name="twitter:description" content="Latest writing on indie hacking, coding, and creative experiments.">
    <meta name="twitter:image" content="{% static 'img/og-default.jpg' %}">
  {% endif %}
{% endblock %}
{% block content %}
<div class="home-container">
  <h1 class="page-title">Latest Posts</h1>
  {% if posts %}
    <div class="post-grid">
      {% for post in posts %}
        <div class="post-card">
          {% if post.featured_image %}
            <img class="post-thumb" src="{{ post.featured_image.url }}" alt="{{ post.title }}">
          {% endif %}
          <h2 class="post-title">
            <a href="{% url 'blog:post_detail' post.slug %}">{{ post.title }}</a>
          </h2>
          <p class="post-meta">by {{ post.author }} · {{ post.created_at|date:"M d, Y" }}in <a href="{% url 'blog:category_detail' post.category.slug %}">{{ post.category.name }}</a></p>
          
          <p class="post-snippet">{{ post.content|truncatewords:25 }}</p>
          <a class="read-more" href="{% url 'blog:post_detail' post.slug %}">Read more →</a>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No posts yet.</p>
    <a href="{% url 'blog:post_create' %}">Create the first post?</a>
  {% endif %}
</div>
{% endblock %}

{% if page_obj and page_obj.has_other_pages %}
<nav class="pagination">
  {% with query=request.GET.urlencode %}
    {% if page_obj.has_previous %}
      <a href="?page={{ page_obj.previous_page_number }}{% if query %}&{{ query|cut:'page='|cut:'&' %}{% endif %}">← Prev</a>
    {% endif %}

    <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}{% if query %}&{{ query|cut:'page='|cut:'&' %}{% endif %}">Next →</a>
    {% endif %}
  {% endwith %}
</nav>
{% endif %}

